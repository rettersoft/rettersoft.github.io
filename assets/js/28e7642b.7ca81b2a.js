"use strict";(self.webpackChunkrbs_dev_docs=self.webpackChunkrbs_dev_docs||[]).push([[3651],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return g}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=p(n),g=a,m=c["".concat(l,".").concat(g)]||c[g]||u[g]||s;return n?r.createElement(m,o(o({ref:t},d),{},{components:n})):r.createElement(m,o({ref:t},d))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=c;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var p=2;p<s;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2410:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return i},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return d},default:function(){return c}});var r=n(7462),a=n(3366),s=(n(7294),n(3905)),o=["components"],i={sidebar_position:6},l="Data Object",p={unversionedId:"api-ref/data",id:"api-ref/data",isDocsHomePage:!1,title:"Data Object",description:"Every step handler is handed a data object like below:",source:"@site/docs/api-ref/data.mdx",sourceDirName:"api-ref",slug:"/api-ref/data",permalink:"/docs/api-ref/data",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/api-ref/data.mdx",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"iOS",permalink:"/docs/sdks/ios"}},d=[{value:"data",id:"data",children:[],level:2},{value:"data.context",id:"datacontext",children:[],level:2},{value:"data.method",id:"datamethod",children:[],level:2},{value:"data.method.context",id:"datamethodcontext",children:[],level:2},{value:"data.method.request",id:"datamethodrequest",children:[],level:2},{value:"data.method.response",id:"datamethodresponse",children:[{value:"Example usage:",id:"example-usage",children:[],level:3}],level:2}],u={toc:d};function c(e){var t=e.components,n=(0,a.Z)(e,o);return(0,s.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"data-object"},"Data Object"),(0,s.kt)("p",null,"Every step handler is handed a data object like below:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function sayHello(data: Data): Promise<StepResponse> {\n    return data\n}\n")),(0,s.kt)("p",null,"Step handler can make some changes to data object and return it."),(0,s.kt)("h2",{id:"data"},"data"),(0,s.kt)("p",null,"Data object has following interface:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export interface Data extends StepResponse {\n    context: Context\n    env: KeyValue\n    config: Configuration\n    version: number\n    state: State\n    method: Method\n    schedule: Schedule[]\n}\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"context: Context"))),(0,s.kt)("p",null,"Context contains information about class and first execution of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"env: KeyValue"))),(0,s.kt)("p",null,"Environment variables passed to this class method execution."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"config: Configuration"))),(0,s.kt)("p",null,"Docs coming soon."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"version: number"))),(0,s.kt)("p",null,"Docs coming soon."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"state: State"))),(0,s.kt)("p",null,"State of this instance. It is used to get latest state and also update it by manipulating and returning it."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"method: Method"))),(0,s.kt)("p",null,"Used to read information about this methods context and also read request data like body, statusCode and headers. This field is also used to return a response to the caller."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"schedule: Schedule[]"))),(0,s.kt)("p",null,"Used to schedule a new method call after a delay. "),(0,s.kt)("p",null,"For more info see: ",(0,s.kt)("a",{parentName:"p",href:"/docs/main_concepts/method_scheduling/"},"Scheduling")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"datacontext"},"data.context"),(0,s.kt)("p",null,"This object is filled with information when this instance was created."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export interface Context {\n    requestId: string\n    projectId: string \n    action: string \n    identity: string \n    serviceId?: string\n    headers?: KeyValue \n    classId: string \n    instanceId?: string \n    methodName: string\n    refererClassId?: string\n    refererInstanceId?: string\n    refererMethodName?: string\n    refererUserId?: string\n    refererIdentity?: string\n    claims?: KeyValue\n    isAnonymous?: boolean\n    culture?: string\n    platform?: string\n    userId?: string\n    sourceIP: string\n    sessionId?: string\n    clientOs?: string\n    targetServiceIds?: string[]\n    relatedUserId?: string\n}\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"requestId: string"))),(0,s.kt)("p",null,"Request id of the INIT call."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"projectId: string"))),(0,s.kt)("p",null,"ProjectId of this request."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"action: string"))),(0,s.kt)("p",null,'Action is a special string used internally by retter. data.context object always has "rbs.core.request.INSTANCE" as its action.'),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"identity: string"))),(0,s.kt)("p",null,"Role of the user who created this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"headers?: KeyValue"))," "),(0,s.kt)("p",null,"Headers used to initialize this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"classId: string"))," "),(0,s.kt)("p",null,"ClassId of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"instanceId?: string"))," "),(0,s.kt)("p",null,"Unique id of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"methodName: string"))),(0,s.kt)("p",null,'This methodName is always "INIT" in data.context. '),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"claims?: KeyValue"))),(0,s.kt)("p",null,"Data included in the JWT token used when creating this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"isAnonymous?: boolean"))),(0,s.kt)("p",null,"Was the creator of the instance anonymous? If so: true."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"userId?: string"))),(0,s.kt)("p",null,"User id of the creator of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"sourceIP: string"))),(0,s.kt)("p",null,"IP address of the creator of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"clientOs?: string"))),(0,s.kt)("p",null,"Client operating system of the creator of this instance."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"datamethod"},"data.method"),(0,s.kt)("p",null,"Method object is used to read incoming request and write data to returning response. It's interface is like below:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"interface Method {\n    name: string\n    context: Context\n    state: KeyValue\n    request?: Request\n    response?: Response\n}\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"name: string"))),(0,s.kt)("p",null,"Name of the method."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"context: string"))),(0,s.kt)("p",null,"Context contains information like identities, ip addresses for this request."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"state: string"))),(0,s.kt)("p",null,"Method state is a temporary storage which is passed from step to step. It is not stored after the method returns. You can use it to pass data between your steps but don't want to store that state in persistent state."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"request: string"))),(0,s.kt)("p",null,"Request object contains data sent to this method."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"response: string"))," "),(0,s.kt)("p",null,"You use response object to write data to the response of this method. Example usage:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},'data.method.response = {\n    statusCode: 200,\n    headers: {\n        "content-type": "application/json"\n    },\n    body: {\n        message: "OK"\n    }\n}\n')),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"datamethodcontext"},"data.method.context"),(0,s.kt)("p",null,"Method context is filled at every method request with following information."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export interface Context {\n    requestId: string\n    projectId: string \n    action: string \n    identity: string \n    serviceId?: string\n    headers?: KeyValue \n    classId: string \n    instanceId?: string \n    methodName: string\n    refererClassId?: string\n    refererInstanceId?: string\n    refererMethodName?: string\n    refererUserId?: string\n    refererIdentity?: string\n    claims?: KeyValue\n    isAnonymous?: boolean\n    culture?: string\n    platform?: string\n    userId?: string\n    sourceIP: string\n    sessionId?: string\n    clientOs?: string\n    targetServiceIds?: string[]\n    relatedUserId?: string\n}\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"requestId: string"))),(0,s.kt)("p",null,"Request id of method call."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"projectId: string"))),(0,s.kt)("p",null,"ProjectId of this request."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"action: string"))),(0,s.kt)("p",null,'Action is a special string used internally by retter. data.method.context object always has "rbs.core.request.CALL" as its action.'),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"identity: string"))),(0,s.kt)("p",null,"Role of the user who is making this call."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"classId: string"))," "),(0,s.kt)("p",null,"ClassId of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"instanceId?: string"))," "),(0,s.kt)("p",null,"Unique id of this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"methodName: string"))),(0,s.kt)("p",null,"Name of this method."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"claims?: KeyValue"))),(0,s.kt)("p",null,"Data included in the JWT token used when creating this instance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"isAnonymous?: boolean"))),(0,s.kt)("p",null,"Is the caller of this method anonymous?"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"userId?: string"))),(0,s.kt)("p",null,"User id of the caller."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"sourceIP: string"))),(0,s.kt)("p",null,"IP address of the caller."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"clientOs?: string"))),(0,s.kt)("p",null,"Client operating system of caller."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"datamethodrequest"},"data.method.request"),(0,s.kt)("p",null,"Request object contains incoming data in this method call."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export interface Request {\n    httpMethod: string\n    body?: any\n    headers: { [key: string]: string }\n    queryStringParams: { [key: string]: string }\n}\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"httpMethod: string"))),(0,s.kt)("p",null,"Http method of the call like: GET, POST, PUT etc."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"body: string"))),(0,s.kt)("p",null,"Post body of http request."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"headers: string"))),(0,s.kt)("p",null,"Headers sent from the client."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"queryStringParams: string"))),(0,s.kt)("p",null,"Query strings sent in this request."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"datamethodresponse"},"data.method.response"),(0,s.kt)("p",null,"Response object can be used to return a response to the caller."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"export interface CloudObjectResponse {\n    statusCode: number\n    body?: any\n    headers?: { [key: string]: string }\n}\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"statusCode: string"))),(0,s.kt)("p",null,"Returning statusCode."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"body: string"))),(0,s.kt)("p",null,"Response body of this method."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},(0,s.kt)("inlineCode",{parentName:"strong"},"headers: string"))),(0,s.kt)("p",null,"Headers sent to the client."),(0,s.kt)("h3",{id:"example-usage"},"Example usage:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},'export async function sayHello(data: Data): Promise<StepResponse> {\n    data.method.response = {\n        statusCode: 200,\n        headers: {\n            "content-type": "application/json"\n        },\n        body: {\n            message: "Hello"\n        }\n    }\n    return data\n}\n')))}c.isMDXComponent=!0}}]);