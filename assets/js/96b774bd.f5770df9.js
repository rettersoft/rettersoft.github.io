"use strict";(self.webpackChunkrio_doc=self.webpackChunkrio_doc||[]).push([[2197],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return h}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(n),h=r,y=d["".concat(l,".").concat(h)]||d[h]||p[h]||o;return n?a.createElement(y,s(s({ref:t},u),{},{components:n})):a.createElement(y,s({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3157:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return p}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),s=["components"],i={id:"State",sidebar_label:"State",sidebar_position:4},l="State",c={unversionedId:"Concepts/Classes/State",id:"Concepts/Classes/State",title:"State",description:"Every instance has a state. This state is stored within the object. Best practice is to keep the size of this state relatively small. For instance if you are developing a chat application you might hold last 100 messages in state but store the rest in a sortedSet. However we will only talk about state in this article.",source:"@site/docs/Concepts/Classes/State.md",sourceDirName:"Concepts/Classes",slug:"/Concepts/Classes/State",permalink:"/docs/Concepts/Classes/State",editUrl:"https://github.com/rettersoft/rettersoft.github.io/blob/main/docs/Concepts/Classes/State.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"State",sidebar_label:"State",sidebar_position:4},sidebar:"ConceptsSideBar",previous:{title:"Instances",permalink:"/docs/Concepts/Classes/Instances"},next:{title:"Init",permalink:"/docs/Concepts/Classes/InitMethod"}},u={},p=[{value:"Public",id:"public",level:4},{value:"Private",id:"private",level:4},{value:"User",id:"user",level:4},{value:"Role",id:"role",level:4},{value:"What do you do with state?",id:"what-do-you-do-with-state",level:3},{value:"getState function",id:"getstate-function",level:3}],d={toc:p};function h(e){var t=e.components,n=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"state"},"State"),(0,o.kt)("p",null,"Every instance has a state. This state is stored within the object. Best practice is to keep the size of this state relatively small. For instance if you are developing a chat application you might hold last 100 messages in state but store the rest in a sortedSet. However we will only talk about state in this article.\nState object gets streamed to client sdk\u2019s in real time.\nState consists of four parts:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "public": {},\n  "private": {},\n  "user": {\n    "userId1": { }\n  },\n  "role": {\n    "roleName1": { }\n  }\n}\n')),(0,o.kt)("h4",{id:"public"},"Public"),(0,o.kt)("p",null,"Public state can be seen by every client connected."),(0,o.kt)("h4",{id:"private"},"Private"),(0,o.kt)("p",null,"Private state doesn\u2019t get streamed to any client. Only server side code (objects methods) can see and edit this state."),(0,o.kt)("h4",{id:"user"},"User"),(0,o.kt)("p",null,"User object has userId\u2019s in it. Each userId node contains the data specific for that userId. Only that user is allowed to see that data."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'{\n    "userId": {\n        "userId1": {}\n    }\n}\n')),(0,o.kt)("h4",{id:"role"},"Role"),(0,o.kt)("p",null,"Role state can be seen by anybody who has that role."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'{\n    "roleId": {\n        "roleName1": {}\n    }\n}\n')),(0,o.kt)("h3",{id:"what-do-you-do-with-state"},"What do you do with state?"),(0,o.kt)("p",null,"In your server side code you update the state object any way you want. Clients connected to this object will receive updates according to their permission level."),(0,o.kt)("h3",{id:"getstate-function"},"getState function"),(0,o.kt)("p",null,"Clients can either get the state via REST api or they can subscribe to state via sdk."),(0,o.kt)("p",null,"If you want to get your state via REST api you can define a delegate function in your template file and customize what part of state you will return to anybody making the call. Below there is a ",(0,o.kt)("inlineCode",{parentName:"p"},"getState")," function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"getState: index.getState\n")),(0,o.kt)("p",null,"Below is the implementation of getState function which returns private state to any caller. Of course this is pretty unsecure. Don\u2019t do this at home :)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"export async function getState(data: Data): Promise<Response> {\n    return { \n        statusCode: 200, \n        body: {\n            ...data.state.private,\n        }\n    }\n}\n")),(0,o.kt)("p",null,"Actually any method can be used to returning part of or full state to any caller. ",(0,o.kt)("inlineCode",{parentName:"p"},"getState")," is a special method used in developer console. Other than that you can write another method and use it from your clients."))}h.isMDXComponent=!0}}]);