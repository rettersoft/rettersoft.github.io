"use strict";(self.webpackChunkrbs_dev_docs=self.webpackChunkrbs_dev_docs||[]).push([[5501],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=o,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||a;return n?r.createElement(h,i(i({ref:t},c),{},{components:n})):r.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3698:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},assets:function(){return c},toc:function(){return p},default:function(){return m}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],l={slug:"cloudobject-a-simple-user-with-auth-part-2-3",title:"CloudObject \u2014 A Simple User with Auth \u2014 Part 2/3",authors:"baran",tags:["Serverless","Rtbs","Rbs","Cloudobjects"]},s=void 0,u={permalink:"/blog/cloudobject-a-simple-user-with-auth-part-2-3",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/blog/blog/2021-12-06-cloudobject-a-simple-user-with*auth-part-2-3.md",source:"@site/blog/2021-12-06-cloudobject-a-simple-user-with*auth-part-2-3.md",title:"CloudObject \u2014 A Simple User with Auth \u2014 Part 2/3",description:"In the last part we have implemented a signup method. Now we will add a method for signin in. Let\u2019s change our template as follows:",date:"2021-12-06T00:00:00.000Z",formattedDate:"December 6, 2021",tags:[{label:"Serverless",permalink:"/blog/tags/serverless"},{label:"Rtbs",permalink:"/blog/tags/rtbs"},{label:"Rbs",permalink:"/blog/tags/rbs"},{label:"Cloudobjects",permalink:"/blog/tags/cloudobjects"}],readingTime:1.055,truncated:!1,authors:[{name:"Baran Baygan",title:"Solution Architect",url:"https://github.com/baranbaygan",imageURL:"https://miro.medium.com/fit/c/262/262/1*QxTUo9SYcZQj8EomGLqOPA.jpeg",key:"baran"}],prevItem:{title:"An object oriented cloud",permalink:"/blog/an-object-oriented-cloud"},nextItem:{title:"CloudObject \u2014 A Simple User with Auth \u2014 Part 1/3",permalink:"/blog/cloudobject-a-simple-user-with-auth-part-1-3"}},c={authorsImageUrls:[void 0]},p=[],d={toc:p};function m(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"In the last part we have implemented a signup method. Now we will add a method for signin in. Let\u2019s change our template as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"preAuthorizer: index.preAuthorizer\nauthorizer: index.authorizer\ninit: index.init\ngetState: index.getState\ngetInstanceId: index.getInstanceId\nmethods:\n    - method: addMoney\n      tag: test\n      sync: true\n      steps:\n          - id: addMoney\n            \n    - method: spendMoney\n      tag: test\n      sync: true\n      steps:\n          - id: spendMoney\n            handler: index.spendMoneyHandler\n          - id: success\n          - id: insufficientFunds\n            handler: index.handler\n      flow:\n          - direction:\n                - spendMoney\n                - success\n          - id: gotoInsufficientFunds\n            direction:\n                - spendMoney\n                - insufficientFunds\n\n\n")),(0,a.kt)("p",null,"So our class diagram looks like this:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*wx68mhOaeNxx397UAMd_Hw.png",alt:"rtbs screenshot"})),(0,a.kt)("p",null,"We already have our generateToken function implemented. That will stay the same. Let\u2019s implement the rest; validateCredentials and invalidCredentials"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*KggpuTwzIz4Ekeizidw8Ow.png",alt:"rtbs screenshot"})),(0,a.kt)("p",null,"If you don\u2019t define a nextFlowId the next flow direction without any id will be executed. So validateCredentials will lead to generateToken"),(0,a.kt)("p",null,"Of course credential validation is not going to be like this. You probably should bcrypt the password when saving it and compare bcrypted versions. But for sake of simplicity let\u2019s just compare clear text passwords."),(0,a.kt)("p",null,"Invalid credentials step updates response object and sets statusCode to 403."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://miro.medium.com/max/1400/1*rrTk-wM1FgA2f6xEJ-T41Q.png",alt:"rtbs screenshot"})),(0,a.kt)("p",null,"Otherwise generateToken is called and a token will be returned to the client."),(0,a.kt)("p",null,"In the next part we will implement the preAuthorizer and authorizer functions."),(0,a.kt)("p",null,"Thanks."))}m.isMDXComponent=!0}}]);