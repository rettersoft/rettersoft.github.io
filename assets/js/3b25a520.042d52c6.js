"use strict";(self.webpackChunkrio_doc=self.webpackChunkrio_doc||[]).push([[2203],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=d(n),h=o,m=u["".concat(l,".").concat(h)]||u[h]||p[h]||r;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var d=2;d<r;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6725:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return p}});var a=n(7462),o=n(3366),r=(n(7294),n(3905)),i=["components"],s={id:"MethodType",sidebar_label:"Method Types",sidebar_position:2},l="Method Type and Concurrency",d={unversionedId:"Concepts/Classes/Methods/MethodType",id:"Concepts/Classes/Methods/MethodType",title:"Method Type and Concurrency",description:"There are two important parameters defining how a method works.",source:"@site/docs/Concepts/Classes/Methods/MethodType.md",sourceDirName:"Concepts/Classes/Methods",slug:"/Concepts/Classes/Methods/MethodType",permalink:"/docs/Concepts/Classes/Methods/MethodType",editUrl:"https://github.com/rettersoft/rettersoft.github.io/blob/main/docs/Concepts/Classes/Methods/MethodType.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"MethodType",sidebar_label:"Method Types",sidebar_position:2},sidebar:"ConceptsSideBar",previous:{title:"About Methods",permalink:"/docs/Concepts/Classes/Methods/AboutMethods"},next:{title:"Validation",permalink:"/docs/Concepts/Classes/Methods/Validation"}},c={},p=[{value:"Type (State Access Type)",id:"type-state-access-type",level:2},{value:"READ",id:"read",level:3},{value:"WRITE",id:"write",level:3},{value:"STATIC",id:"static",level:3},{value:"Method Types Table",id:"method-types-table",level:3},{value:"Method Invocation Type",id:"method-invocation-type",level:2},{value:"QUEUED",id:"queued",level:3},{value:"IMMEDIATE",id:"immediate",level:3},{value:"Diagram",id:"diagram",level:3}],u={toc:p};function h(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"method-type-and-concurrency"},"Method Type and Concurrency"),(0,r.kt)("p",null,"There are two important parameters defining how a method works."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"type"),": Defines what data method can access. (State Access Type)"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"invocationType"),": Defined when to execute incoming requests.")),(0,r.kt)("h2",{id:"type-state-access-type"},"Type (State Access Type)"),(0,r.kt)("p",null,"Rio has 3 different types of methods. You can specify method type like below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"methods:\n  - method: sayHello\n    type: READ | WRITE | STATIC\n    handler: index.sayHello\n")),(0,r.kt)("h3",{id:"read"},"READ"),(0,r.kt)("p",null,"READ methods can read state but they cannot change it. They run at concurrency N. You can call them in parallel. "),(0,r.kt)("h3",{id:"write"},"WRITE"),(0,r.kt)("p",null,"WRITE methods can read and also change state. They always run at concurrency 1. There is no chance that any WRITE method can end up in a race condition and over write each others state updates. "),(0,r.kt)("p",null,"If you set invocationType: IMMEDIATE on a WRITE method then your request takes precedence in the queue and gets executed before every other message. Let's say you have two methods like below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"methods:\n  - method: foo\n    invocationType: IMMEDIATE\n    type: WRITE\n    handler: index.foo\n  - method: bar\n    invocationType: QUEUED\n    type: WRITE\n    handler: index.bar\n")),(0,r.kt)("p",null,"You can send messages to ",(0,r.kt)("inlineCode",{parentName:"p"},"bar")," and they get queued. They will be sent to your method one after another. While those messages are being processed you can call method ",(0,r.kt)("inlineCode",{parentName:"p"},"foo"),". One of two things can happen."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Your message to ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," gets processed right away. It gets precedence before every other message left in the FIFO queue."),(0,r.kt)("li",{parentName:"ol"},"Your message to ",(0,r.kt)("inlineCode",{parentName:"li"},"foo")," gets rejected with a ",(0,r.kt)("inlineCode",{parentName:"li"},"statusCode:570"),". This means there was a method in process so Rio rejected the request to this instance. Client should retry this message with an exponential backoff algorithm. ")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Rio Client SDK's are already retrying these 570 status codes by default. However you can change that behaviour in SDK configuration.")),(0,r.kt)("h3",{id:"static"},"STATIC"),(0,r.kt)("p",null,"You can call STATIC methods without instanceId. "),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"https://{PROJECT_ID}}.api.retter.io/{PROJECT_ID}/CALL/{CLASS_NAME}/{METHOD_NAME}")),(0,r.kt)("p",null,"They don't have state. They are running in concurrency N. They are good for stateless API methods. You can still read and write to resources like files and memory instead of instance state."),(0,r.kt)("h3",{id:"method-types-table"},"Method Types Table"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"State"),(0,r.kt)("th",{parentName:"tr",align:null},"Concurrency"),(0,r.kt)("th",{parentName:"tr",align:null},"External Resources (Files etc)"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"READ"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"WRITE"),(0,r.kt)("td",{parentName:"tr",align:null},"YES"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"YES")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"STATIC"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"YES")))),(0,r.kt)("h2",{id:"method-invocation-type"},"Method Invocation Type"),(0,r.kt)("p",null,"Methods have different invocation types. Invocation type dictates wheter or not the request will be queued or handled immediately."),(0,r.kt)("h3",{id:"queued"},"QUEUED"),(0,r.kt)("p",null,"QUEUED methods don't receive requests directly. These requests get queued in instance level FIFO queue and sent to methods one by one. As a side effect QUEUED methods don't return a response."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"methods:\n  - method: foo\n    invocationType: QUEUED\n    type: WRITE\n    handler: index.foo\n")),(0,r.kt)("h3",{id:"immediate"},"IMMEDIATE"),(0,r.kt)("p",null,"IMMEDIATE methods requests are directly sent to method. You can return a response to the caller by setting ",(0,r.kt)("inlineCode",{parentName:"p"},"data.response")," field."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"methods:\n  - method: foo\n    invocationType: IMMEDIATE\n    type: WRITE\n    handler: index.foo\n")),(0,r.kt)("p",null,"If you have a IMMEDIATE & WRITE method then there is a chance you might get an status code error 570 from Rio. This means currenly this instance is busy processing another WRITE method. If you receive status code 570 then you should retry the request. Rio SDK's by default have this retrying mechanism. You can overwrite retry values. By default SDK's retry 5 times with exponential backoff."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Important thing is, if you receive 570 from an instance, Rio pauses QUEUE processing by that instance for 3 seconds giving the caller to get in between messages by next try. So if the caller receives 570 and retries after 500 ms there is a good chance of being able to process that request, assuming on going method execution will be finished under 500 ms."))),(0,r.kt)("h3",{id:"diagram"},"Diagram"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://static.rtbs.io/images/method-invocation.png",alt:"Method Invocation Diagram"})))}h.isMDXComponent=!0}}]);