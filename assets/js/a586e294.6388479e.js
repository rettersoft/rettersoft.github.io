"use strict";(self.webpackChunkrbs_dev_docs=self.webpackChunkrbs_dev_docs||[]).push([[6947],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},l=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),l=p(n),m=o,f=l["".concat(i,".").concat(m)]||l[m]||d[m]||a;return n?r.createElement(f,s(s({ref:t},u),{},{components:n})):r.createElement(f,s({ref:t},u))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=l;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,s[1]=c;for(var p=2;p<a;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}l.displayName="MDXCreateElement"},7916:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return i},metadata:function(){return p},toc:function(){return u},default:function(){return l}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),s=["components"],c={sidebar_position:5},i="Sorted Sets",p={unversionedId:"main_concepts/sortedSets",id:"main_concepts/sortedSets",isDocsHomePage:!1,title:"Sorted Sets",description:"An instance has a state to store its data. But there are some cases where a state is not the perfect place to store your data.",source:"@site/docs/main_concepts/sortedSets.mdx",sourceDirName:"main_concepts",slug:"/main_concepts/sortedSets",permalink:"/docs/main_concepts/sortedSets",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/main_concepts/sortedSets.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Authorization",permalink:"/docs/main_concepts/authorization"},next:{title:"Global Memory",permalink:"/docs/main_concepts/globalMemory"}},u=[],d={toc:u};function l(e){var t=e.components,n=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"sorted-sets"},"Sorted Sets"),(0,a.kt)("p",null,"An instance has a state to store its data. But there are some cases where a state is not the perfect place to store your data. "),(0,a.kt)("p",null,"Think of a chat application. A chat room instance cannot hold all messages since the beginning of the time. At some point some messages need to be stored somewhere else. "),(0,a.kt)("p",null,"Sorted sets can be used for these kind of use cases. Sorted sets are basically a key value storage with a part and sort key. First get a sdk instance."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"import SDK, { Data, InitResponse, Response, StepResponse } from './CloudObjects'\n\nconst sdk = new SDK()\n")),(0,a.kt)("p",null,"Now we can start writing to a sorted set like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'export async function addChatMessage(data: Data): Promise<StepResponse> {\n\n    await sdk.addToSortedSet({\n        setName: "messages",\n        sortKey: Date.now().toString(),\n        data: {\n            "senderId": data.method.context.userId,\n            "message": data.method.request.body.message\n        }\n    })\n\n    data.method.response = { statusCode: 200, body: { success: true }}\n\n    return data\n}\n')),(0,a.kt)("p",null,"When a new user opens this chat room she needs to be able to fetch latest messages like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'export async function getMessages(data: Data): Promise<StepResponse> {\n\n    let queryResult = await sdk.querySortedSet({\n        setName: "messages",\n        limit: 50\n    })\n\n    data.method.response = {\n        statusCode: 200,\n        body: {\n            messages: queryResult.data\n        }\n    }\n\n    return data\n}\n')))}l.isMDXComponent=!0}}]);