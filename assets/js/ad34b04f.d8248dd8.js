"use strict";(self.webpackChunkrbs_dev_docs=self.webpackChunkrbs_dev_docs||[]).push([[74],{3905:function(e,t,r){r.d(t,{Zo:function(){return l},kt:function(){return m}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),p=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},l=function(e){var t=p(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),d=p(r),m=o,f=d["".concat(c,".").concat(m)]||d[m]||u[m]||a;return r?n.createElement(f,s(s({ref:t},l),{},{components:r})):n.createElement(f,s({ref:t},l))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,s=new Array(a);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var p=2;p<a;p++)s[p]=r[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},4236:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return i},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return l},default:function(){return d}});var n=r(7462),o=r(3366),a=(r(7294),r(3905)),s=["components"],i={sidebar_position:4},c="Best Practices",p={unversionedId:"process-manager/best-practices",id:"process-manager/best-practices",isDocsHomePage:!1,title:"Best Practices",description:"Working With Responses",source:"@site/docs/process-manager/best-practices.mdx",sourceDirName:"process-manager",slug:"/process-manager/best-practices",permalink:"/docs/process-manager/best-practices",editUrl:"https://github.com/facebook/docusaurus/edit/main/website/docs/process-manager/best-practices.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Components",permalink:"/docs/process-manager/components"},next:{title:"Tutorial Intro",permalink:"/docs/intro"}},l=[{value:"Working With Responses",id:"working-with-responses",children:[{value:"Designing Loops",id:"designing-loops",children:[],level:3}],level:2}],u={toc:l};function d(e){var t=e.components,r=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"best-practices"},"Best Practices"),(0,a.kt)("h2",{id:"working-with-responses"},"Working With Responses"),(0,a.kt)("p",null,"It's common to fork a path in a process by response of a service call.\nWhile you're doing that, you should consider what you will put into ",(0,a.kt)("em",{parentName:"p"},"state")," to use in your conditional flows."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"const GetOrderNotRecommendedWay  = {\n    id: 'GET_ORDER',\n    action: 'rbs.order.request.DATA',\n    service: 'rbs.oms',\n    parameters: { orderId: '$.payload.orderId' },\n    outputPath: '$.0',\n    resultPath: 'order',\n    errorPath: '$.0.errors.0',\n    onSuccess: { 'order.status': { EQ: 200 } }\n}\n")),(0,a.kt)("p",null,"Step definition above, tries to get details of an order from OMS via a synchronous service call.\nAs always, RBS Core middleware responds with an array and each item includes the original response from service as well as some metadata about HTTP communication between Process Manager and service such as headers, status, etc."),(0,a.kt)("p",null,"If you save ",(0,a.kt)("em",{parentName:"p"},"\\$.0")," into state that means you will have more data than you actually need for your implementation.\nInstead of that, you should consider saving ",(0,a.kt)("em",{parentName:"p"},"$.0.response")," directly."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"const GetOrder =  {\n    id: 'GET_ORDER',\n    action: 'rbs.order.request.DATA',\n    service: 'rbs.oms',\n    parameters: { orderId: '$.payload.orderId' },\n    outputPath: '$.0.response',\n    resultPath: 'order',\n    errorPath: '$.0.errors.0',\n    onSuccess: { 'order.orderId': { EX: true } }\n}\n")),(0,a.kt)("h3",{id:"designing-loops"},"Designing Loops"),(0,a.kt)("p",null,"You can design a loop just like ",(0,a.kt)("em",{parentName:"p"},"for")," in general programming. That kind of loops require a variable to track steps."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"const GetOrder =  {\n    id: 'GET_ORDER',\n    action: 'rbs.order.request.DATA',\n    service: 'rbs.oms',\n    parameters: { orderId: '$.payload.orderId' },\n    outputPath: '$.0.response',\n    resultPath: 'order',\n    errorPath: '$.0.errors.0',\n    onSuccess: { 'order.orderId': { EX: true } }\n}\n\nconst Loop =  {\n    id: 'LOOP',\n    st: '{{ retry + 1 }}',\n    resultPath: 'retry',\n    isCompleted: { retry: { GT: 3 } }\n}\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If ",(0,a.kt)("inlineCode",{parentName:"p"},"GetOrder")," fails, process should continue with ",(0,a.kt)("inlineCode",{parentName:"p"},"Loop")," step until the current value of ",(0,a.kt)("inlineCode",{parentName:"p"},"retry")," is greater than ",(0,a.kt)("em",{parentName:"p"},"3"),". In initial state or one of the earlier steps of process, we should set ",(0,a.kt)("inlineCode",{parentName:"p"},"retry")," as ",(0,a.kt)("em",{parentName:"p"},"0"),".")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"It's also possible to implement a loop by consuming an array or object. But it's much more complicated than ",(0,a.kt)("em",{parentName:"p"},"for"),"-like loops, requires more steps and more open to end up with an infinite loop accidentally. You should consider risk of malfunction or higher cost if you decide to implement ",(0,a.kt)("em",{parentName:"p"},"while"),"-like loops. You can see how to implement that kind of loop in Typescript below.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"const items = [ 1, 2, 3, 4, 5 ];\nlet sum = 0;\nwhile (items.length) {\n    const n = items.pop();\n    if (typeof n === 'number') sum += n;\n}\nconsole.log('sum: ', sum)\n")))}d.isMDXComponent=!0}}]);